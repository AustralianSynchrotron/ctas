\hypertarget{kernel_8cpp}{
\subsection{/home/antonmx/work/projects/ctascmake/src/common/kernel.cpp File Reference}
\label{kernel_8cpp}\index{/home/antonmx/work/projects/ctascmake/src/common/kernel.cpp@{/home/antonmx/work/projects/ctascmake/src/common/kernel.cpp}}
}


Reconstruction implementation.  


{\ttfamily \#include \char`\"{}kernel.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}poptmx.h\char`\"{}}\par
{\ttfamily \#include $<$algorithm$>$}\par
{\ttfamily \#include $<$numeric$>$}\par
{\ttfamily \#include $<$time.h$>$}\par
{\ttfamily \#include $<$pthread.h$>$}\par
{\ttfamily \#include $<$gsl/gsl\_\-sf\_\-bessel.h$>$}\par
{\ttfamily \#include $<$unistd.h$>$}\par
\subsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classline__distributor}{line\_\-distributor}
\begin{DoxyCompactList}\small\item\em Thread distributor for the line-\/per-\/thread approach. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
long \hyperlink{group__CT_ga8ef1bda2c874aacbf35db98ebf624053}{nof\_\-threads} (long \_\-threads)
\begin{DoxyCompactList}\small\item\em Number of threads for the process. \item\end{DoxyCompactList}\item 
bool \hyperlink{group__CT_gaf9133142c6dad9960a265f4bed342f1e}{operator==} (const \hyperlink{classFilter}{Filter} \&a, const \hyperlink{classFilter}{Filter} \&b)
\begin{DoxyCompactList}\small\item\em Compare filters. \item\end{DoxyCompactList}\item 
bool \hyperlink{group__CT_ga006e30108fb1535d0038ebc54fa2fef0}{operator!=} (const \hyperlink{classFilter}{Filter} \&a, const \hyperlink{classFilter}{Filter} \&b)
\begin{DoxyCompactList}\small\item\em Compare filters. \item\end{DoxyCompactList}\item 
string \hyperlink{group__CT_gad97b803aaaa6ade957937bfcb55e9640}{type\_\-desc} (\hyperlink{classFilter}{Filter} $\ast$)
\begin{DoxyCompactList}\small\item\em Prints type name. To be used in the CLI parsing via \char`\"{}poptmx\char`\"{} library. \item\end{DoxyCompactList}\item 
bool \hyperlink{group__CT_ga1e87f9e83a0925d1e574f0ac072aa307}{\_\-conversion} (\hyperlink{classFilter}{Filter} $\ast$\_\-val, const string \&in)
\begin{DoxyCompactList}\small\item\em Converts the string \char`\"{}in\char`\"{} into the \hyperlink{classFilter}{Filter} \_\-val. To be used in the CLI parsing via \char`\"{}poptmx\char`\"{} library. \item\end{DoxyCompactList}\item 
static void \hyperlink{kernel_8cpp_a435ba042bc9621ff77d13d8033809182}{filter\_\-line} (\hyperlink{group__Types_ga4ce3fdeba27702c8b09a141e22709e38}{Line} \&ln, const \hyperlink{group__Types_ga4ce3fdeba27702c8b09a141e22709e38}{Line} \&f\_\-win, const fftwf\_\-plan $\ast$planF, const fftwf\_\-plan $\ast$planB)
\begin{DoxyCompactList}\small\item\em Applies FFT filter to one line. \item\end{DoxyCompactList}\item 
static void \hyperlink{kernel_8cpp_aed17fc51bda610a3f24b5dcff824467f}{project\_\-line} (const \hyperlink{group__Types_ga4ce3fdeba27702c8b09a141e22709e38}{Line} \&sino, \hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&result, float Theta, float center)
\begin{DoxyCompactList}\small\item\em Projects one line onto the plane. \item\end{DoxyCompactList}\item 
static void \hyperlink{kernel_8cpp_ab8576893134b36765bf9189afc1247f2}{project\_\-sino} (const \hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&sinogram, \hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&result, float center)
\begin{DoxyCompactList}\small\item\em Projects the sinogram. \item\end{DoxyCompactList}\item 
static void $\ast$ \hyperlink{kernel_8cpp_abf796c1b84c57844fb2222f8248943af}{project\_\-line\_\-thr} (void $\ast$\_\-args)
\begin{DoxyCompactList}\small\item\em Work for thread in the line-\/per-\/thread approach. \item\end{DoxyCompactList}\item 
static void \hyperlink{kernel_8cpp_a27b66291cecde3164f7bad5fad758353}{project\_\-sino} (const \hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&sinogram, \hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&result, float center, int threads)
\begin{DoxyCompactList}\small\item\em Projects the sinogram using multithreaded approach. \item\end{DoxyCompactList}\item 
void \hyperlink{group__CT_ga5808611b08d2e9151075e49b8d0722a0}{ts\_\-add} (\hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&projection, \hyperlink{group__Types_ga8747378c016fc11d9ecbb98787248c25}{Map} \&result, const \hyperlink{classFilter}{Filter} \&filter, const float center, const \hyperlink{classContrast}{Contrast} contrast, const float angle, const int plane)
\end{DoxyCompactItemize}
\subsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const string \hyperlink{group__CT_ga2ebf6d4c37d89c3fbadf5a0c62943305}{FilterOptionDesc} = \char`\"{} and their graphs can be found in the html documentation.\char`\"{}
\begin{DoxyCompactList}\small\item\em Description of the option giving the \hyperlink{classFilter}{Filter} type. \item\end{DoxyCompactList}\item 
static const int \hyperlink{kernel_8cpp_a3495bac5515bab54258643f4c0e8cb73}{TR\_\-conf} = 1 $<$$<$ 16
\begin{DoxyCompactList}\small\item\em The int to float conversion coefficient. \item\end{DoxyCompactList}\item 
const string \hyperlink{group__CT_gaa85f25c1d37beee97a296412da28b664}{CenterOptionDesc} = \char`\"{} from the ImageMagick package with the -\/rotate option.\char`\"{}
\begin{DoxyCompactList}\small\item\em Description of the option giving the rotation center. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
Reconstruction implementation. \begin{DoxyAuthor}{Author}
antonmx $<$\href{mailto:antonmx@gmail.com}{\tt antonmx@gmail.com}$>$ 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
Thu Jul 17 13:22:00 2008
\end{DoxyDate}
All functions which implement the actual reconstruction are defined here. 

Definition in file \hyperlink{kernel_8cpp_source}{kernel.cpp}.



\subsubsection{Function Documentation}
\hypertarget{kernel_8cpp_a435ba042bc9621ff77d13d8033809182}{
\index{kernel.cpp@{kernel.cpp}!filter\_\-line@{filter\_\-line}}
\index{filter\_\-line@{filter\_\-line}!kernel.cpp@{kernel.cpp}}
\paragraph[{filter\_\-line}]{\setlength{\rightskip}{0pt plus 5cm}static void filter\_\-line (
\begin{DoxyParamCaption}
\item[{{\bf Line} \&}]{ln, }
\item[{const {\bf Line} \&}]{f\_\-win, }
\item[{const fftwf\_\-plan $\ast$}]{planF, }
\item[{const fftwf\_\-plan $\ast$}]{planB}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline, static\mbox{]}}}\hfill}
\label{kernel_8cpp_a435ba042bc9621ff77d13d8033809182}


Applies FFT filter to one line. 


\begin{DoxyParams}{Parameters}
{\em ln} & Line to be filtered. \\
\hline
{\em f\_\-win} & \hyperlink{classFilter}{Filter} window. \\
\hline
{\em planF} & Forward FFT plan. \\
\hline
{\em planB} & Backward FFT plan. \\
\hline
\end{DoxyParams}


Definition at line 330 of file kernel.cpp.



Referenced by CTrec::addLine\_\-uni(), CTrec::reconstruct\_\-uni(), and ts\_\-add().

\hypertarget{kernel_8cpp_aed17fc51bda610a3f24b5dcff824467f}{
\index{kernel.cpp@{kernel.cpp}!project\_\-line@{project\_\-line}}
\index{project\_\-line@{project\_\-line}!kernel.cpp@{kernel.cpp}}
\paragraph[{project\_\-line}]{\setlength{\rightskip}{0pt plus 5cm}static void project\_\-line (
\begin{DoxyParamCaption}
\item[{const {\bf Line} \&}]{sino, }
\item[{{\bf Map} \&}]{result, }
\item[{float}]{Theta, }
\item[{float}]{center}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}\hfill}
\label{kernel_8cpp_aed17fc51bda610a3f24b5dcff824467f}


Projects one line onto the plane. 


\begin{DoxyParams}{Parameters}
{\em sino} & Line to be projected. \\
\hline
{\em result} & Plane to project to. \\
\hline
{\em Theta} & Rotation angle. \\
\hline
{\em center} & Deviation of the rotation center. \\
\hline
\end{DoxyParams}


Definition at line 347 of file kernel.cpp.



References TR\_\-conf.



Referenced by CTrec::addLine\_\-uni(), project\_\-line\_\-thr(), and project\_\-sino().

\hypertarget{kernel_8cpp_abf796c1b84c57844fb2222f8248943af}{
\index{kernel.cpp@{kernel.cpp}!project\_\-line\_\-thr@{project\_\-line\_\-thr}}
\index{project\_\-line\_\-thr@{project\_\-line\_\-thr}!kernel.cpp@{kernel.cpp}}
\paragraph[{project\_\-line\_\-thr}]{\setlength{\rightskip}{0pt plus 5cm}static void$\ast$ project\_\-line\_\-thr (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{\_\-args}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline, static\mbox{]}}}\hfill}
\label{kernel_8cpp_abf796c1b84c57844fb2222f8248943af}


Work for thread in the line-\/per-\/thread approach. 


\begin{DoxyParams}{Parameters}
{\em \_\-args} & Arguments: distributor.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
No return. 
\end{DoxyReturn}


Definition at line 481 of file kernel.cpp.



References line\_\-distributor::center(), line\_\-distributor::distribute(), project\_\-line(), and line\_\-distributor::result().



Referenced by project\_\-sino().

\hypertarget{kernel_8cpp_a27b66291cecde3164f7bad5fad758353}{
\index{kernel.cpp@{kernel.cpp}!project\_\-sino@{project\_\-sino}}
\index{project\_\-sino@{project\_\-sino}!kernel.cpp@{kernel.cpp}}
\paragraph[{project\_\-sino}]{\setlength{\rightskip}{0pt plus 5cm}static void project\_\-sino (
\begin{DoxyParamCaption}
\item[{const {\bf Map} \&}]{sinogram, }
\item[{{\bf Map} \&}]{result, }
\item[{float}]{center, }
\item[{int}]{threads}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline, static\mbox{]}}}\hfill}
\label{kernel_8cpp_a27b66291cecde3164f7bad5fad758353}


Projects the sinogram using multithreaded approach. 


\begin{DoxyParams}{Parameters}
{\em sinogram} & Sinogram to be projected \\
\hline
{\em result} & The result to store the final projection. \\
\hline
{\em center} & Rotation center. \\
\hline
{\em threads} & Number of threads. \\
\hline
\end{DoxyParams}


Definition at line 501 of file kernel.cpp.



References project\_\-line\_\-thr(), project\_\-sino(), and throw\_\-error().

\hypertarget{kernel_8cpp_ab8576893134b36765bf9189afc1247f2}{
\index{kernel.cpp@{kernel.cpp}!project\_\-sino@{project\_\-sino}}
\index{project\_\-sino@{project\_\-sino}!kernel.cpp@{kernel.cpp}}
\paragraph[{project\_\-sino}]{\setlength{\rightskip}{0pt plus 5cm}static void project\_\-sino (
\begin{DoxyParamCaption}
\item[{const {\bf Map} \&}]{sinogram, }
\item[{{\bf Map} \&}]{result, }
\item[{float}]{center}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline, static\mbox{]}}}\hfill}
\label{kernel_8cpp_ab8576893134b36765bf9189afc1247f2}


Projects the sinogram. 


\begin{DoxyParams}{Parameters}
{\em sinogram} & Sinogram to be projected \\
\hline
{\em result} & The result to store the final projection. \\
\hline
{\em center} & Rotation center. \\
\hline
\end{DoxyParams}


Definition at line 384 of file kernel.cpp.



References project\_\-line().



Referenced by project\_\-sino(), and CTrec::reconstruct\_\-uni().



\subsubsection{Variable Documentation}
\hypertarget{kernel_8cpp_a3495bac5515bab54258643f4c0e8cb73}{
\index{kernel.cpp@{kernel.cpp}!TR\_\-conf@{TR\_\-conf}}
\index{TR\_\-conf@{TR\_\-conf}!kernel.cpp@{kernel.cpp}}
\paragraph[{TR\_\-conf}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf TR\_\-conf} = 1 $<$$<$ 16\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}\hfill}
\label{kernel_8cpp_a3495bac5515bab54258643f4c0e8cb73}


The int to float conversion coefficient. 

The calculations using float point numbers are much more expensive comparing to that of the integer type. In order to save time in the sensitive code it is possible to convert limited float numbers into integer ones, perform all linear calculations in the integer space and convert the result back to the float space. \hyperlink{kernel_8cpp_a3495bac5515bab54258643f4c0e8cb73}{TR\_\-conf} gives the multiplication coefficient used to convert the float number limited to $\pm1.0$ (it is the cosine and sine of some value) to the integer. 

Definition at line 319 of file kernel.cpp.



Referenced by project\_\-line().

