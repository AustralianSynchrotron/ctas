<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ctas: /home/antonmx/work/projects/ctascmake/src/common/ledei.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ctas&#160;<span id="projectnumber">0.5.2</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_3d54202a3b8ee27d21a2088f81ee8e9a.html">src</a>      </li>
      <li class="navelem"><a class="el" href="dir_2f355405f57d8b2bf2067fc213a1a45e.html">common</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>ledei.cpp</h1>  </div>
</div>
<div class="contents">
<a href="ledei_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/******************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *   Copyright (C) 2007 by Anton Maksimenko                                   *</span>
<a name="l00003"></a>00003 <span class="comment"> *   antonmx@post.kek.jp                                                      *</span>
<a name="l00004"></a>00004 <span class="comment"> *                                                                            *</span>
<a name="l00005"></a>00005 <span class="comment"> *   This program is free software; you can redistribute it and/or modify     *</span>
<a name="l00006"></a>00006 <span class="comment"> *   it under the terms of the GNU General Public License as published by     *</span>
<a name="l00007"></a>00007 <span class="comment"> *   the Free Software Foundation; either version 2 of the License, or        *</span>
<a name="l00008"></a>00008 <span class="comment"> *   (at your option) any later version.                                      *</span>
<a name="l00009"></a>00009 <span class="comment"> *                                                                            *</span>
<a name="l00010"></a>00010 <span class="comment"> *   This program is distributed in the hope that it will be useful,          *</span>
<a name="l00011"></a>00011 <span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of           *</span>
<a name="l00012"></a>00012 <span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            *</span>
<a name="l00013"></a>00013 <span class="comment"> *   GNU General Public License for more details.                             *</span>
<a name="l00014"></a>00014 <span class="comment"> *                                                                            *</span>
<a name="l00015"></a>00015 <span class="comment"> *   You should have received a copy of the GNU General Public License        *</span>
<a name="l00016"></a>00016 <span class="comment"> *   along with this program; if not, write to the                            *</span>
<a name="l00017"></a>00017 <span class="comment"> *   Free Software Foundation, Inc.,                                          *</span>
<a name="l00018"></a>00018 <span class="comment"> *   59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.                *</span>
<a name="l00019"></a>00019 <span class="comment"> ******************************************************************************/</span>
<a name="l00020"></a>00020 
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="edei_8h.html" title="Header file with common classes needed in the EDEI processing.">edei.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="poptmx_8h.html" title="Template-oriented library for CLI parsing.">poptmx.h</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">using namespace </span>std;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 
<a name="l00043"></a>00043 <span class="keywordtype">string</span>
<a name="l00044"></a><a class="code" href="group__edeiedei.html#ga9473b5ac52a3b4d72a1569eb3719ee4c">00044</a> <a class="code" href="group__edeiedei.html#ga9473b5ac52a3b4d72a1569eb3719ee4c" title="Prints name.">Interp::name</a>()<span class="keyword"> const </span>{
<a name="l00045"></a>00045   <span class="keywordflow">switch</span> (mpinter) {
<a name="l00046"></a>00046   <span class="keywordflow">case</span> ALPHA:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;alpha&quot;</span>;
<a name="l00047"></a>00047   <span class="keywordflow">case</span> NUMBER: <span class="keywordflow">return</span> <span class="stringliteral">&quot;number&quot;</span>;
<a name="l00048"></a>00048   <span class="keywordflow">case</span> REFLECT:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;reflectivity&quot;</span>;
<a name="l00049"></a>00049   <span class="keywordflow">case</span> INTENS:   <span class="keywordflow">return</span> <span class="stringliteral">&quot;intensity&quot;</span>;
<a name="l00050"></a>00050   <span class="keywordflow">default</span> :
<a name="l00051"></a>00051           <a class="code" href="group__Error.html#gacb8a74cf255f5788357a30ce8b4f80db" title="Reports and throws the bug.">throw_bug</a>(__FUNCTION__);
<a name="l00052"></a>00052           <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00053"></a>00053   }
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 
<a name="l00058"></a>00058 <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87" title="Determines the meaning of the input +/- points in the EDEIprocess::mpinter.">Interp::inter_tp</a>
<a name="l00059"></a><a class="code" href="group__edeiedei.html#ga0fb3fe592af6060f4d27b7e59e864808">00059</a> <a class="code" href="group__edeiedei.html#ga0fb3fe592af6060f4d27b7e59e864808" title="The interpretation type.">Interp::type</a>()<span class="keyword"> const  </span>{
<a name="l00060"></a>00060   <span class="keywordflow">return</span> mpinter;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00064"></a><a class="code" href="group__edeiedei.html#ga039d1a049fa99eb2238712041637945e">00064</a> <a class="code" href="group__edeiedei.html#ga039d1a049fa99eb2238712041637945e" title="Constructor.">Interp::Interp</a>(<a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87" title="Determines the meaning of the input +/- points in the EDEIprocess::mpinter.">inter_tp</a> _mpinter) : mpinter(_mpinter) {
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 
<a name="l00069"></a><a class="code" href="group__edeiedei.html#ga3d8b610ff638db6518ab5f538bbbae07">00069</a> <a class="code" href="group__edeiedei.html#ga039d1a049fa99eb2238712041637945e" title="Constructor.">Interp::Interp</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp; _name) {
<a name="l00070"></a>00070   <span class="keywordtype">string</span> <a class="code" href="group__edeiedei.html#ga9473b5ac52a3b4d72a1569eb3719ee4c" title="Prints name.">name</a> = <a class="code" href="group__CommonFunctions.html#gafb844ea13cbc3a3596026448ace0a808" title="Convert string to upper case.">upper</a>(_name);
<a name="l00071"></a>00071   <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;A&quot;</span> || name == <span class="stringliteral">&quot;ALPHA&quot;</span> ) <a class="code" href="classInterp.html#af2350a967b89741ad75e3c8725d32a56" title="The interpretation.">mpinter</a> = <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ac3491d178c3b4d99946346d29aa1a278" title="Angle  (x-axis).">ALPHA</a>;
<a name="l00072"></a>00072   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;N&quot;</span> || name == <span class="stringliteral">&quot;NUMBER&quot;</span> ) <a class="code" href="classInterp.html#af2350a967b89741ad75e3c8725d32a56" title="The interpretation.">mpinter</a> = <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ad059eb3ed702d77d4a397615966abe49" title="Number of the string in the read RCstaff::RCoption() &amp;quot;RC&amp;quot; file.">NUMBER</a>;
<a name="l00073"></a>00073   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;R&quot;</span> || name == <span class="stringliteral">&quot;REFLECTIVITY&quot;</span> ) <a class="code" href="classInterp.html#af2350a967b89741ad75e3c8725d32a56" title="The interpretation.">mpinter</a> = <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87addb4fb6c1edaa033ac3bd54e0f79f297" title="Reflectivity (y-axis).">REFLECT</a>;
<a name="l00074"></a>00074   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( name == <span class="stringliteral">&quot;I&quot;</span> || name == <span class="stringliteral">&quot;INTENSITY&quot;</span> ) <a class="code" href="classInterp.html#af2350a967b89741ad75e3c8725d32a56" title="The interpretation.">mpinter</a> = <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87aaaeebe62ae30762d4708f741e206fe91" title="Intensity (y-axis).">INTENS</a>;
<a name="l00075"></a>00075   <span class="keywordflow">else</span> <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;point interpretation&quot;</span>, <span class="stringliteral">&quot;The string \&quot;&quot;</span>+ _name +<span class="stringliteral">&quot;\&quot;&quot;</span>
<a name="l00076"></a>00076                                    <span class="stringliteral">&quot; does not describe any known point interpretation.&quot;</span>);
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="keyword">const</span> std::string <a class="code" href="group__edeiedei.html#gad0a1bf1abf92a9db8a77c55470a31027" title="Description of the type.">Interp::optionDesc</a> =
<a name="l00080"></a>00080   <span class="stringliteral">&quot;Can be one of the following strings (case insensitive):\n&quot;</span>
<a name="l00081"></a>00081   <span class="stringliteral">&quot;  \&quot;A\&quot;, \&quot;ALPHA\&quot; -  Sets the meaning of the +/- values to the angle&quot;</span>
<a name="l00082"></a>00082   <span class="stringliteral">&quot; \\alpha. I.e. finds the given value on the \\alpha axis of the RC&quot;</span>
<a name="l00083"></a>00083   <span class="stringliteral">&quot; (first column in the input RC file) and sets the position&quot;</span>
<a name="l00084"></a>00084   <span class="stringliteral">&quot; to the found point.\n&quot;</span>
<a name="l00085"></a>00085   <span class="stringliteral">&quot;  \&quot;N\&quot;, \&quot;NUMBER\&quot; - Sets the meaning of the +/- values to&quot;</span>
<a name="l00086"></a>00086   <span class="stringliteral">&quot; the RC index. Converts values to integer and considers them as the&quot;</span>
<a name="l00087"></a>00087   <span class="stringliteral">&quot; index on the RC&#39;s \\alpha axis. In other words the given values&quot;</span>
<a name="l00088"></a>00088   <span class="stringliteral">&quot; represent the string in the RC file which corresponds to the position.\n&quot;</span>
<a name="l00089"></a>00089   <span class="stringliteral">&quot;  \&quot;I\&quot;, \&quot;INTENSITY\&quot; - Sets the meaning of the +/- values to the intensity.&quot;</span>
<a name="l00090"></a>00090   <span class="stringliteral">&quot; I.e. finds the given value on the intensity axis of the RC (second column&quot;</span>
<a name="l00091"></a>00091   <span class="stringliteral">&quot; in the input RC file) and sets the position to the found point.\n&quot;</span>
<a name="l00092"></a>00092   <span class="stringliteral">&quot;  \&quot;R\&quot;, \&quot;REFLECTIVITY\&quot; - Sets the meaning of the +/- values to&quot;</span>
<a name="l00093"></a>00093   <span class="stringliteral">&quot; the reflectivity. Similar to \&quot;INTENSITY\&quot;, but normalizes the&quot;</span>
<a name="l00094"></a>00094   <span class="stringliteral">&quot; intensities and interprets the values as the normalized ones.&quot;</span>;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="group__edeiedei.html#ga3f78c281778943826ca58723ba34544f">00097</a> <span class="keywordtype">bool</span> <a class="code" href="group__Types.html#ga9e64a10e0cc4fff11763fa59660ec038" title="Compare contrasts.">operator==</a>(<span class="keyword">const</span> <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> &amp; a, <span class="keyword">const</span> <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> &amp; b){
<a name="l00098"></a>00098   <span class="keywordflow">return</span>  a.<a class="code" href="group__edeiedei.html#ga0fb3fe592af6060f4d27b7e59e864808" title="The interpretation type.">type</a>() == b.<a class="code" href="group__edeiedei.html#ga0fb3fe592af6060f4d27b7e59e864808" title="The interpretation type.">type</a>() ;
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="group__edeiedei.html#ga0eca9f735bcba12f1dd183c990f9814f">00101</a> <span class="keywordtype">bool</span> <a class="code" href="group__Types.html#gaebd775321a5c08374eaed2b227b83552" title="Compare contrasts.">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> &amp; a, <span class="keyword">const</span> <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> &amp; b){
<a name="l00102"></a>00102   <span class="keywordflow">return</span>  a.<a class="code" href="group__edeiedei.html#ga0fb3fe592af6060f4d27b7e59e864808" title="The interpretation type.">type</a>() != b.<a class="code" href="group__edeiedei.html#ga0fb3fe592af6060f4d27b7e59e864808" title="The interpretation type.">type</a>() ;
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="keywordtype">string</span>
<a name="l00106"></a><a class="code" href="group__edeiedei.html#ga516b630e8236082e31aba169d8a5e545">00106</a> <a class="code" href="group__Types.html#ga8fd2857cd3b4a7006c31dd06af0f3e78" title="Prints type name. To be used in the CLI parsing via &amp;quot;poptmx&amp;quot; library.">type_desc</a> (<a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a>*){
<a name="l00107"></a>00107   <span class="keywordflow">return</span> <span class="stringliteral">&quot;STRING&quot;</span>;
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="keywordtype">bool</span>
<a name="l00111"></a><a class="code" href="group__edeiedei.html#ga9a8006fafee97e85fd5c0aedcd86f5ef">00111</a> <a class="code" href="group__Types.html#ga4e0eee1b7fdba3969d084be434981931" title="Converts the string &amp;quot;in&amp;quot; into the Path _val. To be used in the CLI parsing via &amp;quot;poptmx...">_conversion</a> (<a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a>* _val, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp; in) {
<a name="l00112"></a>00112   *_val=<a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a>(in);
<a name="l00113"></a>00113   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00114"></a>00114 }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 
<a name="l00126"></a>00126 <a class="code" href="classpoptmx_1_1OptionTable.html" title="The table of known options.">poptmx::OptionTable</a>
<a name="l00127"></a><a class="code" href="group__edeiedei.html#gae31714a01a177e8ada6450dbd5a343cc">00127</a> <a class="code" href="group__edeiedei.html#gae31714a01a177e8ada6450dbd5a343cc" title="Constructor.">EDEIoptions::options</a>() {
<a name="l00128"></a>00128   <a class="code" href="classpoptmx_1_1OptionTable.html" title="The table of known options.">poptmx::OptionTable</a> opt
<a name="l00129"></a>00129     (<span class="stringliteral">&quot;EDEI processing options.&quot;</span>,
<a name="l00130"></a>00130      <span class="stringliteral">&quot;Options which influence the component extraction via the EDEI method.&quot;</span>);
<a name="l00131"></a>00131   opt
<a name="l00132"></a>00132     .<a class="code" href="classpoptmx_1_1OptionTable.html#a19543d734743ed851ce0b9036383dcc7" title="Adds the entry in to the table.">add</a>(<a class="code" href="group__poptmx.html#gga3f58821f631b466567d001183ca437e2affc5b1466e5baa32ed759fa555b93166" title="Option.">poptmx::OPTION</a>, &amp;<a class="code" href="structEDEIoptions.html#a293daefe2fbeb36296107fd1db32640c" title="Value determining the minus position.">Gm</a>, <span class="charliteral">&#39;m&#39;</span>, <span class="stringliteral">&quot;minus-point&quot;</span>,
<a name="l00133"></a>00133          <span class="stringliteral">&quot;Value determining the minus-point.&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(<a class="code" href="structEDEIoptions.html#a293daefe2fbeb36296107fd1db32640c" title="Value determining the minus position.">Gm</a>))
<a name="l00134"></a>00134     .add(<a class="code" href="group__poptmx.html#gga3f58821f631b466567d001183ca437e2affc5b1466e5baa32ed759fa555b93166" title="Option.">poptmx::OPTION</a>, &amp;<a class="code" href="structEDEIoptions.html#a849c6335c3368bb43cc774e27ab9103d" title="Value determining the plus position.">Gp</a>, <span class="charliteral">&#39;p&#39;</span>, <span class="stringliteral">&quot;plus-point&quot;</span>,
<a name="l00135"></a>00135          <span class="stringliteral">&quot;Value determining the plus-point.&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(<a class="code" href="structEDEIoptions.html#a849c6335c3368bb43cc774e27ab9103d" title="Value determining the plus position.">Gp</a>));
<a name="l00136"></a>00136   opt
<a name="l00137"></a>00137     .<a class="code" href="classpoptmx_1_1OptionTable.html#a19543d734743ed851ce0b9036383dcc7" title="Adds the entry in to the table.">add</a>(<a class="code" href="group__poptmx.html#gga3f58821f631b466567d001183ca437e2a79795e03cf07b845739edbd17b593efd" title="Note.">poptmx::NOTE</a>, <span class="stringliteral">&quot;&quot;</span>,
<a name="l00138"></a>00138          <span class="stringliteral">&quot;Options \&quot;&quot;</span> + opt.<a class="code" href="classpoptmx_1_1OptionTable.html#a0a66ac0e3297c36f516ff4d70ed04a80" title="Returns the description of the entry with the value.">desc</a>(&amp;<a class="code" href="structEDEIoptions.html#a293daefe2fbeb36296107fd1db32640c" title="Value determining the minus position.">Gm</a>) + <span class="stringliteral">&quot;\&quot; and \&quot;&quot;</span> + opt.<a class="code" href="classpoptmx_1_1OptionTable.html#a0a66ac0e3297c36f516ff4d70ed04a80" title="Returns the description of the entry with the value.">desc</a>(&amp;<a class="code" href="structEDEIoptions.html#a849c6335c3368bb43cc774e27ab9103d" title="Value determining the plus position.">Gp</a>) +
<a name="l00139"></a>00139          <span class="stringliteral">&quot;\&quot;. The meaning of the value is defined by the -I|--meaning option.&quot;</span>)
<a name="l00140"></a>00140     .add(<a class="code" href="group__poptmx.html#gga3f58821f631b466567d001183ca437e2affc5b1466e5baa32ed759fa555b93166" title="Option.">poptmx::OPTION</a>, &amp;<a class="code" href="structEDEIoptions.html#a8b89e570e1103169de51b967713a0b80" title="Interpretation of the ::Gm, ::Gp.">mpinter</a>, <span class="charliteral">&#39;I&#39;</span>, <span class="stringliteral">&quot;meaning&quot;</span>,
<a name="l00141"></a>00141          <span class="stringliteral">&quot;Meaning of &quot;</span> + opt.<a class="code" href="classpoptmx_1_1OptionTable.html#a0a66ac0e3297c36f516ff4d70ed04a80" title="Returns the description of the entry with the value.">desc</a>(&amp;<a class="code" href="structEDEIoptions.html#a293daefe2fbeb36296107fd1db32640c" title="Value determining the minus position.">Gm</a>) + <span class="stringliteral">&quot; and &quot;</span> + opt.<a class="code" href="classpoptmx_1_1OptionTable.html#a0a66ac0e3297c36f516ff4d70ed04a80" title="Returns the description of the entry with the value.">desc</a>(&amp;<a class="code" href="structEDEIoptions.html#a849c6335c3368bb43cc774e27ab9103d" title="Value determining the plus position.">Gp</a>) +
<a name="l00142"></a>00142          <span class="stringliteral">&quot; options.&quot;</span>, <a class="code" href="group__edeiedei.html#gad0a1bf1abf92a9db8a77c55470a31027" title="Description of the type.">Interp::optionDesc</a>, <a class="code" href="structEDEIoptions.html#a8b89e570e1103169de51b967713a0b80" title="Interpretation of the ::Gm, ::Gp.">mpinter</a>.<a class="code" href="group__edeiedei.html#ga9473b5ac52a3b4d72a1569eb3719ee4c" title="Prints name.">name</a>())
<a name="l00143"></a>00143     .add(<a class="code" href="group__poptmx.html#gga3f58821f631b466567d001183ca437e2affc5b1466e5baa32ed759fa555b93166" title="Option.">poptmx::OPTION</a>, &amp;<a class="code" href="structEDEIoptions.html#a6a32d7dfbbb0c5af80dfa73e4bef35f2" title="X-axis (angle) conversion factor.">acof</a>, <span class="charliteral">&#39;S&#39;</span>, <span class="stringliteral">&quot;scale&quot;</span>,
<a name="l00144"></a>00144          <span class="stringliteral">&quot;Data-to-angle conversion coefficient.&quot;</span>,
<a name="l00145"></a>00145          <span class="stringliteral">&quot;Multiplication of this coefficient by the value in the first column of&quot;</span>
<a name="l00146"></a>00146          <span class="stringliteral">&quot; the rocking curve data file gives the actual angle in radians.&quot;</span>,
<a name="l00147"></a>00147          <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(<a class="code" href="structEDEIoptions.html#a6a32d7dfbbb0c5af80dfa73e4bef35f2" title="X-axis (angle) conversion factor.">acof</a>))
<a name="l00148"></a>00148     <span class="comment">/*.add(poptmx::OPTION, &amp;smooth, &#39;F&#39;, &quot;filter-rc&quot;,</span>
<a name="l00149"></a>00149 <span class="comment">         &quot;Smooth RC to avoid non-monotonous parts.&quot;,</span>
<a name="l00150"></a>00150 <span class="comment">         &quot;The rocking curve in real experiment is never ideal and includes&quot;</span>
<a name="l00151"></a>00151 <span class="comment">         &quot; noise. If this option is used, the data of the rocking curve&quot;</span>
<a name="l00152"></a>00152 <span class="comment">         &quot; are first smoothed using very primitive algorithm. If you need&quot;</span>
<a name="l00153"></a>00153 <span class="comment">         &quot; some advanced smoothing algorithm, pre-process the data before&quot;</span>
<a name="l00154"></a>00154 <span class="comment">         &quot; using them.&quot;)*/</span>;
<a name="l00155"></a>00155   <span class="keywordflow">return</span> opt;
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="keyword">const</span> std::string <a class="code" href="group__edeiedei.html#ga1d5c3f1289ef962d44d52f344e932369" title="Description of the FD option.">EDEIoptions::fdOptionDesc</a> =
<a name="l00161"></a>00161   <span class="stringliteral">&quot;The EDEI algorithm (described in \&quot;A. Maksimenko, Nonlinear extension of the&quot;</span>
<a name="l00162"></a>00162   <span class="stringliteral">&quot; x-ray diffraction enhanced imaging, Appl. Phys. Lett. 90, 154106 (2007)\&quot;)&quot;</span>
<a name="l00163"></a>00163   <span class="stringliteral">&quot; makes use of the function derived from the RC of the analyzer (see&quot;</span>
<a name="l00164"></a>00164   <span class="stringliteral">&quot; function $F^{-1}$ defined in eq.(3)). The file assumes one virtual axis X&quot;</span>
<a name="l00165"></a>00165   <span class="stringliteral">&quot; which represents the value $x=(I_L-I_H)/(I_L-I_H)$ and can be constructed&quot;</span>
<a name="l00166"></a>00166   <span class="stringliteral">&quot; from the number of the line (n) in the file as follows: $x=2*(n-1)/(N-1)-1$,&quot;</span>
<a name="l00167"></a>00167   <span class="stringliteral">&quot; where N is the total number of lines in the file. The file itself must&quot;</span>
<a name="l00168"></a>00168   <span class="stringliteral">&quot; consist only of the strings of the form:\n&quot;</span>
<a name="l00169"></a>00169   <span class="stringliteral">&quot;    &lt;alpha&gt; &lt;LH&gt;\n&quot;</span>
<a name="l00170"></a>00170   <span class="stringliteral">&quot;where both elements are the floating-point numbers and &lt;alpha&gt; is the&quot;</span>
<a name="l00171"></a>00171   <span class="stringliteral">&quot; $\\alpha(x)=F^{-1}(x)$, while &lt;LH&gt; is the combination of the reflectivities&quot;</span>
<a name="l00172"></a>00172   <span class="stringliteral">&quot; on the low- and high-angle side of the RC $I_L+I_H$ in the corresponding&quot;</span>
<a name="l00173"></a>00173   <span class="stringliteral">&quot; $\\alpha(x)$ position.&quot;</span>;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="keyword">const</span> std::string <a class="code" href="group__edeiedei.html#ga270b21583b3f075758bd30fd3df8f7fa" title="Short description of the FD option.">EDEIoptions::fdOptionShortDesc</a> =
<a name="l00176"></a>00176   <span class="stringliteral">&quot;File containing processed RC used inside the EDEI.&quot;</span>;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 <span class="keyword">const</span> std::string <a class="code" href="group__edeiedei.html#ga4ca0ca5e3acea8517ed7806eca3b9f71" title="Description of the RC option.">EDEIoptions::rcOptionDesc</a> =
<a name="l00180"></a>00180   <span class="stringliteral">&quot;The absence of this option prompts to using the original&quot;</span>
<a name="l00181"></a>00181   <span class="stringliteral">&quot; DEI method.\n&quot;</span>
<a name="l00182"></a>00182   <span class="stringliteral">&quot;Text data file which contains the rocking curve of the analyzer&quot;</span>
<a name="l00183"></a>00183   <span class="stringliteral">&quot; in the EDEI experimental setup. Consists of two columns:&quot;</span>
<a name="l00184"></a>00184   <span class="stringliteral">&quot; X- and Y-axis of the RC. i.e. must contain only the lines of&quot;</span>
<a name="l00185"></a>00185   <span class="stringliteral">&quot; the form:\n&quot;</span>
<a name="l00186"></a>00186   <span class="stringliteral">&quot;    &lt;RC X-axis&gt; &lt;RC Y-axis&gt;\n&quot;</span>
<a name="l00187"></a>00187   <span class="stringliteral">&quot;where both numbers are float point representation of values&quot;</span>
<a name="l00188"></a>00188   <span class="stringliteral">&quot; which are respectively proportional to the RC scan angle and&quot;</span>
<a name="l00189"></a>00189   <span class="stringliteral">&quot; intensity. Note that the RC Y-axis does not have to be the&quot;</span>
<a name="l00190"></a>00190   <span class="stringliteral">&quot; scan angle (it can be motor pulses, encoder value, etc.), it&quot;</span>
<a name="l00191"></a>00191   <span class="stringliteral">&quot; only must be proportional to the scan angle. The same Y-azis&quot;</span>
<a name="l00192"></a>00192   <span class="stringliteral">&quot; does not have to be the reflectivity, but only must be&quot;</span>
<a name="l00193"></a>00193   <span class="stringliteral">&quot; proportional to it. However, if you want to have not only&quot;</span>
<a name="l00194"></a>00194   <span class="stringliteral">&quot; quantitative, but qualitative results (i.e. the results which&quot;</span>
<a name="l00195"></a>00195   <span class="stringliteral">&quot; represent the refraction index itself, not a value proportional&quot;</span>
<a name="l00196"></a>00196   <span class="stringliteral">&quot; to it), you should provide RC with exact data: X-axis in&quot;</span>
<a name="l00197"></a>00197   <span class="stringliteral">&quot; radians and Y-axis in reflectivity.&quot;</span>;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="keyword">const</span> std::string <a class="code" href="group__edeiedei.html#gaf8b9f6e9837dd2d85f8c01071a69b06e" title="Short description of the RC option.">EDEIoptions::rcOptionShortDesc</a> =
<a name="l00201"></a>00201   <span class="stringliteral">&quot;Input file containing the RC of the analyzer.&quot;</span>;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="keywordtype">bool</span>
<a name="l00204"></a><a class="code" href="group__edeiedei.html#gadee6c8302767b3a1728004f89565013c">00204</a> <a class="code" href="group__Types.html#ga4e0eee1b7fdba3969d084be434981931" title="Converts the string &amp;quot;in&amp;quot; into the Path _val. To be used in the CLI parsing via &amp;quot;poptmx...">_conversion</a> (<a class="code" href="classEDEIprocess.html#a745d55d7f97f3aafa52998d49d9acde4" title="Two contrast components available in the EDEI experiment.">EDEIprocess::Component</a>* _val, <span class="keyword">const</span> std::string &amp; in) {
<a name="l00205"></a>00205   std::string _in = <a class="code" href="group__CommonFunctions.html#gafb844ea13cbc3a3596026448ace0a808" title="Convert string to upper case.">upper</a>(in);
<a name="l00206"></a>00206   <span class="keywordflow">if</span> (_in == <span class="stringliteral">&quot;A&quot;</span> || _in == <span class="stringliteral">&quot;ABS&quot;</span> || _in == <span class="stringliteral">&quot;ABSORPTION&quot;</span> )
<a name="l00207"></a>00207     *_val= <a class="code" href="classEDEIprocess.html#a745d55d7f97f3aafa52998d49d9acde4a0ca15c00e66cb8d8eb71439dfad57bae" title="Apparent absorption (abs+small-angle scat.).">EDEIprocess::ABS</a>;
<a name="l00208"></a>00208   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_in == <span class="stringliteral">&quot;R&quot;</span> || _in == <span class="stringliteral">&quot;REF&quot;</span> || _in == <span class="stringliteral">&quot;REFRACTION&quot;</span> )
<a name="l00209"></a>00209     *_val= <a class="code" href="classEDEIprocess.html#a745d55d7f97f3aafa52998d49d9acde4ab2db81707708c7fc95573b0ec104ae9f" title="Clean refraction.">EDEIprocess::REF</a>;
<a name="l00210"></a>00210   <span class="keywordflow">else</span>
<a name="l00211"></a>00211     <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;EDEI component&quot;</span>, <span class="stringliteral">&quot;Unrecognized component\&quot;&quot;</span> + _in + <span class="stringliteral">&quot;\&quot;.&quot;</span>);
<a name="l00212"></a>00212   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 
<a name="l00232"></a>00232 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00233"></a><a class="code" href="group__edeiedei.html#ga7051d1418260969567626bc346f461b6">00233</a> <a class="code" href="group__edeiedei.html#ga7051d1418260969567626bc346f461b6">find_minus</a>( <span class="keywordtype">float</span> Gm, <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> mpinter,
<a name="l00234"></a>00234             <span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp; alpha, <span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp; RC){
<a name="l00235"></a>00235 
<a name="l00236"></a>00236   <span class="keywordtype">int</span> icur=0, maxlocRC = maxIndex(RC)(0);
<a name="l00237"></a>00237   <span class="keywordtype">float</span> minRC = min(RC), maxRC = max(RC);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239   <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ac3491d178c3b4d99946346d29aa1a278" title="Angle  (x-axis).">Interp::ALPHA</a> ) {
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         <span class="keywordflow">if</span> ( Gm &lt;= alpha(0)  ||  Gm &gt;= alpha(maxlocRC) )
<a name="l00242"></a>00242           <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00243"></a>00243                                   <span class="stringliteral">&quot;Specified \\alpha of the minus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gm) + <span class="stringliteral">&quot;)&quot;</span>
<a name="l00244"></a>00244                                   <span class="stringliteral">&quot; is outside the RC minus slope&quot;</span>
<a name="l00245"></a>00245                                   <span class="stringliteral">&quot; [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>( <a class="code" href="group__Types.html#ga777964671cb4315ce8c56c920db031e3" title="Shape of an 2D array.">Shape</a>(alpha(0), alpha(maxlocRC)) ) + <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00246"></a>00246         <span class="keywordflow">while</span> ( alpha(icur) &lt; Gm )
<a name="l00247"></a>00247           icur++;
<a name="l00248"></a>00248         <span class="keywordflow">return</span> ( alpha(icur) - Gm &gt; Gm - alpha(icur-1) ) ?
<a name="l00249"></a>00249           icur - 1 : icur ;
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ad059eb3ed702d77d4a397615966abe49" title="Number of the string in the read RCstaff::RCoption() &amp;quot;RC&amp;quot; file.">Interp::NUMBER</a> ) {
<a name="l00252"></a>00252 
<a name="l00253"></a>00253         <span class="keywordflow">if</span> ( Gm &lt;= 1 || Gm &gt;= maxlocRC )
<a name="l00254"></a>00254           <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00255"></a>00255                                   <span class="stringliteral">&quot;Specified position of the minus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gm) + <span class="stringliteral">&quot;)&quot;</span>
<a name="l00256"></a>00256                                   <span class="stringliteral">&quot; is outside the RC minus slope [1, &quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(maxlocRC) + <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00257"></a>00257         <span class="keywordflow">return</span> int( Gm-1 );
<a name="l00258"></a>00258 
<a name="l00259"></a>00259   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87addb4fb6c1edaa033ac3bd54e0f79f297" title="Reflectivity (y-axis).">Interp::REFLECT</a>) {
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         <span class="keywordflow">if</span> ( Gm &lt;= minRC/maxRC || Gm &gt;= 1.0 )
<a name="l00262"></a>00262           <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00263"></a>00263                                   <span class="stringliteral">&quot;Specified reflectivity of the minus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gm) + <span class="stringliteral">&quot;)&quot;</span>
<a name="l00264"></a>00264                                   <span class="stringliteral">&quot; is outside the RC ranges [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(minRC/maxRC) + <span class="stringliteral">&quot;, 1].&quot;</span>);
<a name="l00265"></a>00265         <span class="keywordflow">return</span> <a class="code" href="group__edeiedei.html#ga7051d1418260969567626bc346f461b6">find_minus</a>( Gm*maxRC, <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87aaaeebe62ae30762d4708f741e206fe91" title="Intensity (y-axis).">Interp::INTENS</a>, alpha, RC );
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87aaaeebe62ae30762d4708f741e206fe91" title="Intensity (y-axis).">Interp::INTENS</a> ) {
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="keywordflow">if</span> ( Gm &lt; minRC || Gm &gt; maxRC )
<a name="l00270"></a>00270           <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00271"></a>00271                                   <span class="stringliteral">&quot;Specified intensity of the minus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gm) + <span class="stringliteral">&quot;) is&quot;</span>
<a name="l00272"></a>00272                                   <span class="stringliteral">&quot; outside the RC ranges [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(<a class="code" href="group__Types.html#ga777964671cb4315ce8c56c920db031e3" title="Shape of an 2D array.">Shape</a>(minRC, maxRC)) + <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00273"></a>00273         <span class="keywordflow">while</span> ( RC( icur ) &lt; Gm )
<a name="l00274"></a>00274           icur++;
<a name="l00275"></a>00275         <span class="keywordflow">return</span> RC(icur) - Gm &gt; Gm - RC(icur-1) ?
<a name="l00276"></a>00276           icur - 1 : icur;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278   } <span class="keywordflow">else</span> {
<a name="l00279"></a>00279 
<a name="l00280"></a>00280           <a class="code" href="group__Error.html#gacb8a74cf255f5788357a30ce8b4f80db" title="Reports and throws the bug.">throw_bug</a>(__FUNCTION__);
<a name="l00281"></a>00281           <span class="keywordflow">return</span> 0;
<a name="l00282"></a>00282   
<a name="l00283"></a>00283   }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00300"></a>00300 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00301"></a><a class="code" href="group__edeiedei.html#gadd73b548c2e26edb9aa533dc7980bb0c">00301</a> <a class="code" href="group__edeiedei.html#gadd73b548c2e26edb9aa533dc7980bb0c">find_plus</a>( <span class="keywordtype">float</span> Gp, <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> mpinter,
<a name="l00302"></a>00302            <span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp; alpha, <span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp; RC){
<a name="l00303"></a>00303 
<a name="l00304"></a>00304   <span class="keywordtype">int</span> maxlocRC=maxIndex(RC)(0), icur=maxlocRC, size = alpha.size();
<a name="l00305"></a>00305   <span class="keywordtype">float</span> minRC = min(RC), maxRC = max(RC);
<a name="l00306"></a>00306 
<a name="l00307"></a>00307   <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ac3491d178c3b4d99946346d29aa1a278" title="Angle  (x-axis).">Interp::ALPHA</a> ) {
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     <span class="keywordflow">if</span> ( Gp &lt;= alpha(maxlocRC) || Gp &gt;= alpha(size-1) )
<a name="l00310"></a>00310       <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00311"></a>00311                                   <span class="stringliteral">&quot;Specified \\alpha of the plus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gp) + <span class="stringliteral">&quot;)&quot;</span>
<a name="l00312"></a>00312                                   <span class="stringliteral">&quot; is outside the RC plus slope&quot;</span>
<a name="l00313"></a>00313                                   <span class="stringliteral">&quot; [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>( <a class="code" href="group__Types.html#ga777964671cb4315ce8c56c920db031e3" title="Shape of an 2D array.">Shape</a>( alpha(maxlocRC), alpha(size-1)) ) + <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00314"></a>00314     <span class="keywordflow">while</span> ( alpha(icur) &lt; Gp )
<a name="l00315"></a>00315       icur++;
<a name="l00316"></a>00316     <span class="keywordflow">return</span> alpha(icur) - Gp &gt; Gp - alpha(icur-1)  ?
<a name="l00317"></a>00317       icur - 1 : icur ;
<a name="l00318"></a>00318 
<a name="l00319"></a>00319   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ad059eb3ed702d77d4a397615966abe49" title="Number of the string in the read RCstaff::RCoption() &amp;quot;RC&amp;quot; file.">Interp::NUMBER</a> ) {
<a name="l00320"></a>00320 
<a name="l00321"></a>00321     <span class="keywordflow">if</span> ( Gp &lt;= maxlocRC || Gp &gt;= size )
<a name="l00322"></a>00322           <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00323"></a>00323                                   <span class="stringliteral">&quot;Specified position of the plus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gp) + <span class="stringliteral">&quot;)&quot;</span>
<a name="l00324"></a>00324                                   <span class="stringliteral">&quot; is outside the RC plus slope&quot;</span>
<a name="l00325"></a>00325                                   <span class="stringliteral">&quot; [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>( <a class="code" href="group__Types.html#ga777964671cb4315ce8c56c920db031e3" title="Shape of an 2D array.">Shape</a> (maxlocRC, size-1 ) ) + <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00326"></a>00326     <span class="keywordflow">return</span> int( Gp-1 );
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87addb4fb6c1edaa033ac3bd54e0f79f297" title="Reflectivity (y-axis).">Interp::REFLECT</a> ) {
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="keywordflow">if</span> ( Gp &lt;= minRC/maxRC || Gp &gt;= 1.0 )
<a name="l00331"></a>00331       <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00332"></a>00332                                   <span class="stringliteral">&quot;Specified reflectivity of the plus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gp) + <span class="stringliteral">&quot;)&quot;</span>
<a name="l00333"></a>00333                                   <span class="stringliteral">&quot; is outside the RC ranges [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(minRC/maxRC) + <span class="stringliteral">&quot;, 1].&quot;</span>);
<a name="l00334"></a>00334     <span class="keywordflow">return</span> <a class="code" href="group__edeiedei.html#gadd73b548c2e26edb9aa533dc7980bb0c">find_plus</a>( Gp*maxRC, <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87aaaeebe62ae30762d4708f741e206fe91" title="Intensity (y-axis).">Interp::INTENS</a>, alpha, RC );
<a name="l00335"></a>00335 
<a name="l00336"></a>00336   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( mpinter == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87aaaeebe62ae30762d4708f741e206fe91" title="Intensity (y-axis).">Interp::INTENS</a> ) {
<a name="l00337"></a>00337     <span class="keywordflow">if</span> ( Gp &lt; minRC || Gp &gt; maxRC )
<a name="l00338"></a>00338       <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;points&quot;</span>,
<a name="l00339"></a>00339                                   <span class="stringliteral">&quot;Specified intensity of the plus point (&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(Gp) + <span class="stringliteral">&quot;) is&quot;</span>
<a name="l00340"></a>00340                                   <span class="stringliteral">&quot; outside the RC ranges [&quot;</span> + <a class="code" href="group__CommonFunctions.html#ga0c99deaa2f9c487d645d3d6807fe899c" title="Prints formatted message to string.">toString</a>(<a class="code" href="group__Types.html#ga777964671cb4315ce8c56c920db031e3" title="Shape of an 2D array.">Shape</a>(minRC, maxRC)) + <span class="stringliteral">&quot;].&quot;</span>);
<a name="l00341"></a>00341     <span class="keywordflow">while</span> ( RC( icur ) &gt; Gp )
<a name="l00342"></a>00342       icur++;
<a name="l00343"></a>00343     <span class="keywordflow">return</span> Gp - RC(icur) &gt; RC(icur-1) - Gp ?
<a name="l00344"></a>00344       icur -1 : icur;
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   } <span class="keywordflow">else</span> {
<a name="l00347"></a>00347 
<a name="l00348"></a>00348           <a class="code" href="group__Error.html#gacb8a74cf255f5788357a30ce8b4f80db" title="Reports and throws the bug.">throw_bug</a>(__FUNCTION__);
<a name="l00349"></a>00349           <span class="keywordflow">return</span> 0;
<a name="l00350"></a>00350   
<a name="l00351"></a>00351   }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 
<a name="l00362"></a>00362 <span class="keyword">static</span> <span class="keywordtype">bool</span>
<a name="l00363"></a><a class="code" href="group__edeiedei.html#ga086a5a5bd40fea8c2b44b7bf61794aef">00363</a> <a class="code" href="group__edeiedei.html#ga086a5a5bd40fea8c2b44b7bf61794aef">has_one_peak</a>(<span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp;arr){
<a name="l00364"></a>00364   <span class="comment">//bool found = false;</span>
<a name="l00365"></a>00365   <span class="keywordtype">int</span> icur = 0, size = arr.size();
<a name="l00366"></a>00366   <span class="keywordflow">while</span> ( arr(icur) &lt;= arr(icur+1)  &amp;&amp;  icur &lt; size-1 )
<a name="l00367"></a>00367     icur++;
<a name="l00368"></a>00368   <span class="keywordflow">if</span> ( icur == size-1 )
<a name="l00369"></a>00369     <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;find peak&quot;</span>, <span class="stringliteral">&quot;This is not RC.&quot;</span>);
<a name="l00370"></a>00370   <span class="keywordflow">while</span> ( arr(icur) &gt;= arr(icur+1)  &amp;&amp;  icur &lt; size-1 )
<a name="l00371"></a>00371     icur++;
<a name="l00372"></a>00372   <span class="keywordflow">return</span> icur == size-1;
<a name="l00373"></a>00373 }
<a name="l00374"></a>00374 
<a name="l00381"></a>00381 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00382"></a><a class="code" href="group__edeiedei.html#ga0c16a5e954ab6ffa3deadb42f94be89d">00382</a> <a class="code" href="group__edeiedei.html#ga0c16a5e954ab6ffa3deadb42f94be89d">msign</a>(<span class="keywordtype">float</span> val){
<a name="l00383"></a>00383   <span class="keywordflow">if</span> (val==0.0) <span class="keywordflow">return</span> 0;
<a name="l00384"></a>00384   <span class="keywordflow">if</span> (val&lt;0.0) <span class="keywordflow">return</span> -1;
<a name="l00385"></a>00385   <span class="keywordflow">if</span> (val&gt;0.0) <span class="keywordflow">return</span> 1;
<a name="l00386"></a>00386   <a class="code" href="group__Error.html#gacb8a74cf255f5788357a30ce8b4f80db" title="Reports and throws the bug.">throw_bug</a>(__FUNCTION__);
<a name="l00387"></a>00387   <span class="keywordflow">return</span> 0;
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 
<a name="l00397"></a>00397 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span>
<a name="l00398"></a><a class="code" href="group__edeiedei.html#gac2df424ffcde11ed7514f1ed31434a55">00398</a> <a class="code" href="group__edeiedei.html#gac2df424ffcde11ed7514f1ed31434a55">filterf</a>(<a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp;arr){
<a name="l00399"></a>00399   <span class="keywordtype">int</span> size = arr.size();
<a name="l00400"></a>00400   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> icur = 1 ; icur &lt; size-1 ; icur++)
<a name="l00401"></a>00401     <span class="keywordflow">if</span> ( <a class="code" href="group__edeiedei.html#ga0c16a5e954ab6ffa3deadb42f94be89d">msign</a>( arr(icur+1)-arr(icur) ) == <a class="code" href="group__edeiedei.html#ga0c16a5e954ab6ffa3deadb42f94be89d">msign</a>( arr(icur-1)-arr(icur) ) )
<a name="l00402"></a>00402       arr(icur) = ( arr(icur-1)+arr(icur)+arr(icur+1) ) / 3.0 ;
<a name="l00403"></a>00403 }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 
<a name="l00418"></a>00418 <span class="keyword">static</span> <span class="keywordtype">float</span>
<a name="l00419"></a><a class="code" href="group__edeiedei.html#ga8d28a7beff8f42ab38aaff792b25206d">00419</a> <a class="code" href="group__edeiedei.html#ga8d28a7beff8f42ab38aaff792b25206d">findindex</a>(<span class="keywordtype">float</span> val, <span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp; arr){
<a name="l00420"></a>00420   <span class="keywordtype">int</span> size = arr.size(), m = 0, M = size - 1, point;
<a name="l00421"></a>00421   <span class="keywordflow">if</span> ( val &lt;= arr(0) ) {
<a name="l00422"></a>00422     <span class="keywordflow">return</span> 0;
<a name="l00423"></a>00423   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( val &gt;= arr(size-1) ) {
<a name="l00424"></a>00424     <span class="keywordflow">return</span> size-1;
<a name="l00425"></a>00425   } <span class="keywordflow">else</span> {
<a name="l00426"></a>00426     <span class="keywordflow">while</span> ( M-m &gt; 1 ) {
<a name="l00427"></a>00427       point = ( M + m ) / 2;
<a name="l00428"></a>00428       <span class="keywordflow">if</span> ( val &lt; arr(point) ) {
<a name="l00429"></a>00429         M = point;
<a name="l00430"></a>00430       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( val &gt; arr(point) ) {
<a name="l00431"></a>00431         m = point;
<a name="l00432"></a>00432       } <span class="keywordflow">else</span> {
<a name="l00433"></a>00433         <span class="keywordflow">return</span> point;
<a name="l00434"></a>00434       }
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436     <span class="keywordflow">return</span> m + (val-arr(m)) / (arr(M)-arr(m));
<a name="l00437"></a>00437   }
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439  
<a name="l00440"></a>00440 
<a name="l00450"></a>00450 <span class="keyword">static</span> <span class="keywordtype">float</span>
<a name="l00451"></a><a class="code" href="group__edeiedei.html#ga89dee3af9e649add0e1b5db34c7f463b">00451</a> <a class="code" href="group__edeiedei.html#ga89dee3af9e649add0e1b5db34c7f463b">findvalue</a> (<span class="keywordtype">float</span> index, <span class="keyword">const</span> <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> &amp;arr){
<a name="l00452"></a>00452   <span class="keywordtype">int</span> sizemo = arr.size()-1;
<a name="l00453"></a>00453   <span class="keywordflow">if</span> ( index == sizemo )
<a name="l00454"></a>00454     <span class="keywordflow">return</span> arr(sizemo);
<a name="l00455"></a>00455   <span class="keywordtype">int</span> pos = index;
<a name="l00456"></a>00456   <span class="keywordtype">float</span> rem = index - pos;
<a name="l00457"></a>00457   <span class="keywordflow">return</span> arr(pos) + rem*(arr(pos+1)-arr(pos)) ;
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 
<a name="l00469"></a>00469 <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span>
<a name="l00470"></a><a class="code" href="group__edeiedei.html#ga6afb620f09765f6c83a3cf4840cc41b9">00470</a> <a class="code" href="group__edeiedei.html#ga6afb620f09765f6c83a3cf4840cc41b9">imin3</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> c){
<a name="l00471"></a>00471   <span class="keywordtype">int</span> curmin = a&lt;b ? a : b;
<a name="l00472"></a>00472   <span class="keywordflow">return</span> curmin&lt;c ? curmin : c;
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="group__edeiedei.html#ga32645490331f1049ac7b8be12b72e9fd" title="Module name.">EDEIprocess::modname</a> = <span class="stringliteral">&quot;RC arguments&quot;</span>;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 
<a name="l00504"></a><a class="code" href="group__edeiedei.html#ga8516a2db50344f5d80f2a2fb8a870534">00504</a> <a class="code" href="group__edeiedei.html#ga8516a2db50344f5d80f2a2fb8a870534" title="Constructor.">EDEIprocess::EDEIprocess</a>(<span class="keyword">const</span> <a class="code" href="classPath.html" title="Path in the directory structure.">Path</a> &amp; RCname, <span class="keywordtype">float</span> _Gm, <span class="keywordtype">float</span> _Gp, <a class="code" href="classInterp.html" title="Auxiliary class: just wrap around inter_tp enumeration.">Interp</a> _mpinter,
<a name="l00505"></a>00505                  <span class="keywordtype">bool</span> _smooth, <span class="keywordtype">float</span> _acof)
<a name="l00506"></a>00506   : acof(_acof), Gp(_Gp), Gm(_Gm), mpinter(_mpinter), smooth(_smooth)
<a name="l00507"></a>00507 {
<a name="l00508"></a>00508   <a class="code" href="classEDEIprocess.html#a27cf3442a11ba3d9e9ca9f4137f61265" title="Array .">AL</a>.resize(<a class="code" href="classEDEIprocess.html#a5261e1cab3a15f020b86594303f2c28c" title="Size of the ::AL and ::PM arrays.">function_size</a>);
<a name="l00509"></a>00509   <a class="code" href="classEDEIprocess.html#a8ed9fc30cd4798e0a90aac2c20e621ec" title="Array .">PM</a>.resize(<a class="code" href="classEDEIprocess.html#a5261e1cab3a15f020b86594303f2c28c" title="Size of the ::AL and ::PM arrays.">function_size</a>);
<a name="l00510"></a>00510   <span class="keywordflow">if</span> ( RCname.empty() )
<a name="l00511"></a>00511         <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<a class="code" href="group__edeiedei.html#ga32645490331f1049ac7b8be12b72e9fd" title="Module name.">modname</a>, <span class="stringliteral">&quot;RC is empty.&quot;</span>);
<a name="l00512"></a>00512   <a class="code" href="group__edeiedei.html#gafbe3ba880d64b341f6cbe684648479ec" title="Loads RC.">loadRC</a>(RCname);
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 
<a name="l00525"></a>00525 <span class="keywordtype">float</span>
<a name="l00526"></a><a class="code" href="group__edeiedei.html#gabc1c9c24e29e022479a8e74c8bc7e86a">00526</a> <a class="code" href="group__edeiedei.html#gabc1c9c24e29e022479a8e74c8bc7e86a">EDEIprocess::extract</a>(<span class="keywordtype">float</span> minus, <span class="keywordtype">float</span> plus, <a class="code" href="classEDEIprocess.html#a745d55d7f97f3aafa52998d49d9acde4" title="Two contrast components available in the EDEI experiment.">Component</a> comp)<span class="keyword"> const </span>{
<a name="l00527"></a>00527   <span class="keywordtype">float</span> PpM = minus + plus;
<a name="l00528"></a>00528   <span class="keywordtype">float</span> enter =  (PpM == 0.0)  ?  0.0  :  (minus-plus)/PpM ;
<a name="l00529"></a>00529   <span class="keywordtype">float</span> position = 0.5 * (enter+1) * (<a class="code" href="classEDEIprocess.html#a5261e1cab3a15f020b86594303f2c28c" title="Size of the ::AL and ::PM arrays.">function_size</a>-1);
<a name="l00530"></a>00530   <span class="keywordtype">int</span> pos = position;
<a name="l00531"></a>00531   <span class="keywordtype">float</span> rem = position - pos;
<a name="l00532"></a>00532   <span class="keywordflow">return</span> comp == <a class="code" href="classEDEIprocess.html#a745d55d7f97f3aafa52998d49d9acde4a0ca15c00e66cb8d8eb71439dfad57bae" title="Apparent absorption (abs+small-angle scat.).">ABS</a> ?
<a name="l00533"></a>00533     PpM / ( <a class="code" href="classEDEIprocess.html#a8ed9fc30cd4798e0a90aac2c20e621ec" title="Array .">PM</a>(pos) + rem * ( <a class="code" href="classEDEIprocess.html#a8ed9fc30cd4798e0a90aac2c20e621ec" title="Array .">PM</a>(pos+1)-<a class="code" href="classEDEIprocess.html#a8ed9fc30cd4798e0a90aac2c20e621ec" title="Array .">PM</a>(pos) ) ) :
<a name="l00534"></a>00534     <a class="code" href="classEDEIprocess.html#a27cf3442a11ba3d9e9ca9f4137f61265" title="Array .">AL</a>(pos) + rem * ( <a class="code" href="classEDEIprocess.html#a27cf3442a11ba3d9e9ca9f4137f61265" title="Array .">AL</a>(pos+1)-<a class="code" href="classEDEIprocess.html#a27cf3442a11ba3d9e9ca9f4137f61265" title="Array .">AL</a>(pos) );
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 
<a name="l00542"></a>00542 <span class="keywordtype">void</span> <a class="code" href="group__edeiedei.html#gafbe3ba880d64b341f6cbe684648479ec" title="Loads RC.">EDEIprocess::</a>
<a name="l00543"></a><a class="code" href="group__edeiedei.html#gafbe3ba880d64b341f6cbe684648479ec">00543</a> <a class="code" href="group__edeiedei.html#gafbe3ba880d64b341f6cbe684648479ec" title="Loads RC.">loadRC</a>(<span class="keyword">const</span> <a class="code" href="classPath.html" title="Path in the directory structure.">Path</a> &amp; filename)<span class="keyword"> const </span>{
<a name="l00544"></a>00544 
<a name="l00545"></a>00545   <span class="keywordflow">if</span> (!<a class="code" href="classEDEIprocess.html#a0ee7ea8bd15cc065be6bc4bb4a08c161" title="value in the first column of the read RCstaff::RCoption() &amp;quot;RC&amp;quot; gives actual angle in radian...">acof</a>)
<a name="l00546"></a>00546         <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>( <a class="code" href="group__edeiedei.html#ga32645490331f1049ac7b8be12b72e9fd" title="Module name.">modname</a>, <span class="stringliteral">&quot;Alpha axes scale factor is zero.&quot;</span>);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> alpha, RC;
<a name="l00549"></a>00549   <a class="code" href="group__IO.html#ga02288ddbc5eb5144a7a92eb0a06ee1b6" title="Loads any amount of lines from data file.">LoadData</a>(filename, &amp;alpha, &amp;RC, (<a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a>*) 0);
<a name="l00550"></a>00550   alpha *= <a class="code" href="classEDEIprocess.html#a0ee7ea8bd15cc065be6bc4bb4a08c161" title="value in the first column of the read RCstaff::RCoption() &amp;quot;RC&amp;quot; gives actual angle in radian...">acof</a> ? <a class="code" href="classEDEIprocess.html#a0ee7ea8bd15cc065be6bc4bb4a08c161" title="value in the first column of the read RCstaff::RCoption() &amp;quot;RC&amp;quot; gives actual angle in radian...">acof</a> : 1.0 ;
<a name="l00551"></a>00551 
<a name="l00552"></a>00552   <span class="keywordtype">int</span> size = RC.size();
<a name="l00553"></a>00553   <span class="keywordflow">if</span> ( size &lt;= 3 )
<a name="l00554"></a>00554     <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;read rc&quot;</span>, <span class="stringliteral">&quot;Size of the input RC file is less than 3.&quot;</span>);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556   <span class="comment">// temporal points to prevent changes in Gp, Gm.</span>
<a name="l00557"></a>00557   <span class="keywordtype">float</span> tGm = <a class="code" href="classEDEIprocess.html#a5f7a6ba365d7b383a2b6c12a344230a2" title="Value determining the minus position.">Gm</a>, tGp = <a class="code" href="classEDEIprocess.html#aef4917e24c6b7a3af7b97a9b37c890b8" title="Value determining the plus position.">Gp</a>;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="comment">// reverses the arrays if alpha axes is decreasing</span>
<a name="l00560"></a>00560   <span class="keywordflow">if</span> ( alpha(0) &gt; alpha(size-1) ){
<a name="l00561"></a>00561     <span class="keywordflow">if</span> ( <a class="code" href="classEDEIprocess.html#a1de13d8e88dc94c8627098298bc87667" title="Interpretation of the ::Gm, ::Gp values.">mpinter</a> == <a class="code" href="classInterp.html#a48f7a943f951c25a9717d1849cf7cd87ad059eb3ed702d77d4a397615966abe49" title="Number of the string in the read RCstaff::RCoption() &amp;quot;RC&amp;quot; file.">Interp::NUMBER</a> ) {
<a name="l00562"></a>00562       <a class="code" href="group__Error.html#gafc17a83d686f911fcbed38f9b4b4fda4" title="Constructs the warning and reports it.">warn</a>(<span class="stringliteral">&quot;read rc&quot;</span>, <span class="stringliteral">&quot;The alpha axis is decreasing and Interpretation of&quot;</span>
<a name="l00563"></a>00563            <span class="stringliteral">&quot; the +/- points set to &#39;&quot;</span> + <a class="code" href="classEDEIprocess.html#a1de13d8e88dc94c8627098298bc87667" title="Interpretation of the ::Gm, ::Gp values.">mpinter</a>.<a class="code" href="group__edeiedei.html#ga9473b5ac52a3b4d72a1569eb3719ee4c" title="Prints name.">name</a>() + <span class="stringliteral">&quot;&#39;.&quot;</span>
<a name="l00564"></a>00564            <span class="stringliteral">&quot; Make sure you know what you are doing.&quot;</span>);
<a name="l00565"></a>00565       tGm = size - 1 - tGm;
<a name="l00566"></a>00566       tGp = size - 1 - tGp;
<a name="l00567"></a>00567     }
<a name="l00568"></a>00568     alpha.reverseSelf(blitz::firstDim);
<a name="l00569"></a>00569     RC.reverseSelf(blitz::firstDim);
<a name="l00570"></a>00570   }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   <span class="keywordtype">int</span>
<a name="l00573"></a>00573         Pminus = <a class="code" href="group__edeiedei.html#ga7051d1418260969567626bc346f461b6">find_minus</a>(tGm, <a class="code" href="classEDEIprocess.html#a1de13d8e88dc94c8627098298bc87667" title="Interpretation of the ::Gm, ::Gp values.">mpinter</a>, alpha, RC),
<a name="l00574"></a>00574         Pplus  = <a class="code" href="group__edeiedei.html#gadd73b548c2e26edb9aa533dc7980bb0c">find_plus</a> (tGp,  <a class="code" href="classEDEIprocess.html#a1de13d8e88dc94c8627098298bc87667" title="Interpretation of the ::Gm, ::Gp values.">mpinter</a>, alpha, RC);
<a name="l00575"></a>00575 
<a name="l00576"></a>00576   <span class="comment">// trivial check and RC normalization</span>
<a name="l00577"></a>00577   <span class="keywordflow">if</span>( min(RC) &lt; 0.0 )
<a name="l00578"></a>00578     <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;read rc&quot;</span>, <span class="stringliteral">&quot;Input RC includes sub-zero data: no sense.&quot;</span>);
<a name="l00579"></a>00579   <span class="keywordflow">if</span>( min(RC) == max(RC) )
<a name="l00580"></a>00580     <a class="code" href="group__Error.html#gaad605c8e899cb915d214127c18a12157" title="Constructs the error, reports and then throws it.">throw_error</a>(<span class="stringliteral">&quot;read rc&quot;</span>, <span class="stringliteral">&quot;All data in the input RC are equal: no scene.&quot;</span>);
<a name="l00581"></a>00581   RC /= max(RC);
<a name="l00582"></a>00582 
<a name="l00583"></a>00583   <span class="comment">// tries to smooth RC</span>
<a name="l00584"></a>00584   <span class="keywordflow">if</span> (<a class="code" href="classEDEIprocess.html#aba287078b716c76c2d2276cec54a4bd3" title="Smooth RC to avoid non-mono regions.">smooth</a>)
<a name="l00585"></a>00585     <span class="keywordflow">while</span> ( ! <a class="code" href="group__edeiedei.html#ga086a5a5bd40fea8c2b44b7bf61794aef">has_one_peak</a>(RC) )
<a name="l00586"></a>00586       <a class="code" href="group__edeiedei.html#gac2df424ffcde11ed7514f1ed31434a55">filterf</a>(RC);
<a name="l00587"></a>00587 
<a name="l00588"></a>00588   <span class="comment">// build interim arrays</span>
<a name="l00589"></a>00589   <span class="keywordtype">int</span> new_size = <a class="code" href="group__edeiedei.html#ga6afb620f09765f6c83a3cf4840cc41b9">imin3</a>( Pplus-Pminus, Pminus, size-1-Pplus );
<a name="l00590"></a>00590   <span class="keywordtype">int</span> thissize = 2 * new_size - 1;
<a name="l00591"></a>00591   <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> _FA( thissize );
<a name="l00592"></a>00592   <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> _ppm( thissize );
<a name="l00593"></a>00593   <span class="keywordtype">float</span> rp, rm, rp0=RC(Pplus), rm0=RC(Pminus);
<a name="l00594"></a>00594   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> icur = 0 ; icur &lt; thissize ; icur++ ) {
<a name="l00595"></a>00595     rp = RC( Pplus  - new_size + icur ) / rp0;
<a name="l00596"></a>00596     rm = RC( Pminus - new_size + icur ) / rm0;
<a name="l00597"></a>00597     _ppm(icur) = rp + rm ;
<a name="l00598"></a>00598     _FA(icur) = (rm-rp) / _ppm(icur);
<a name="l00599"></a>00599   }
<a name="l00600"></a>00600 
<a name="l00601"></a>00601   <span class="comment">// monotonous limits</span>
<a name="l00602"></a>00602   <span class="keywordtype">int</span> minloc = minIndex(_FA)(0), maxloc = maxIndex(_FA)(0);
<a name="l00603"></a>00603   <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> ppm =  _ppm( blitz::Range(minloc, maxloc) );
<a name="l00604"></a>00604   <a class="code" href="group__Types.html#ga4ce3fdeba27702c8b09a141e22709e38" title="1D line with data.">Line</a> FA  =   _FA( blitz::Range(minloc, maxloc) );
<a name="l00605"></a>00605 
<a name="l00606"></a>00606   <span class="keywordtype">float</span> dalpha = alpha(1)-alpha(0);
<a name="l00607"></a>00607   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icur = 0 ; icur &lt; <a class="code" href="classEDEIprocess.html#a5261e1cab3a15f020b86594303f2c28c" title="Size of the ::AL and ::PM arrays.">function_size</a> ; icur++){
<a name="l00608"></a>00608     <span class="keywordtype">float</span> val = 2.0 * icur / (function_size-1) - 1;
<a name="l00609"></a>00609     <span class="keywordtype">float</span> index = <a class="code" href="group__edeiedei.html#ga8d28a7beff8f42ab38aaff792b25206d">findindex</a>( val , FA );
<a name="l00610"></a>00610     <a class="code" href="classEDEIprocess.html#a8ed9fc30cd4798e0a90aac2c20e621ec" title="Array .">PM</a>(icur) = <a class="code" href="group__edeiedei.html#ga89dee3af9e649add0e1b5db34c7f463b">findvalue</a> (index, ppm);
<a name="l00611"></a>00611     <a class="code" href="classEDEIprocess.html#a27cf3442a11ba3d9e9ca9f4137f61265" title="Array .">AL</a>(icur) = dalpha * (minloc+index-new_size);
<a name="l00612"></a>00612   }
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 }
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 
<a name="l00617"></a>00617 
<a name="l00622"></a>00622 <span class="keywordtype">void</span>
<a name="l00623"></a><a class="code" href="group__edeiedei.html#gae6f313c662a444a4bf5516cf9f83dc8c">00623</a> <a class="code" href="group__edeiedei.html#gae6f313c662a444a4bf5516cf9f83dc8c" title="Save read RCstaff::FDoption() &amp;quot;FD&amp;quot;.">EDEIprocess::saveFD</a>(<span class="keyword">const</span> <a class="code" href="classPath.html" title="Path in the directory structure.">Path</a> &amp; filename)<span class="keyword"> const </span>{
<a name="l00624"></a>00624   <a class="code" href="group__IO.html#ga0f88c53b648824e6db8e2dc716d273f0" title="Save any amount of lines into data file.">SaveData</a>(filename, &amp;<a class="code" href="classEDEIprocess.html#a27cf3442a11ba3d9e9ca9f4137f61265" title="Array .">AL</a>, &amp;<a class="code" href="classEDEIprocess.html#a8ed9fc30cd4798e0a90aac2c20e621ec" title="Array .">PM</a>, 0);
<a name="l00625"></a>00625 }
<a name="l00626"></a>00626 
<a name="l00627"></a>00627 <span class="keyword">const</span> std::string <a class="code" href="group__edeiedei.html#ga6222a7fc19bf117145380f89e64292c8" title="Description of the ::Component.">EDEIprocess::componentDesc</a> = 
<a name="l00628"></a>00628   <span class="stringliteral">&quot;Must be one of the following strings (case insensitive):\n&quot;</span>
<a name="l00629"></a>00629   <span class="stringliteral">&quot;A, ABS, ABSORPTION - for the absorption component\n&quot;</span>
<a name="l00630"></a>00630   <span class="stringliteral">&quot;R, REF, REFRACTION - for the refraction component&quot;</span>;
<a name="l00631"></a>00631 
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Apr 8 2011 16:05:59 for ctas by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
